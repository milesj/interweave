<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.60">
<title data-react-helmet="true">HTML parsing | Interweave</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="HTML parsing | Interweave"><meta data-react-helmet="true" name="description" content="Interweave doesn&#x27;t rely on an HTML parser for rendering HTML safely; instead, it uses the DOM"><meta data-react-helmet="true" property="og:description" content="Interweave doesn&#x27;t rely on an HTML parser for rendering HTML safely; instead, it uses the DOM"><meta data-react-helmet="true" property="og:url" content="https://interweave.dev/docs/parser"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.svg"><link data-react-helmet="true" rel="canonical" href="https://interweave.dev/docs/parser"><link rel="stylesheet" href="/styles.f938dd11.css">
<link rel="preload" href="/styles.0d221f0c.js" as="script">
<link rel="preload" href="/runtime~main.565a1149.js" as="script">
<link rel="preload" href="/main.6efb486e.js" as="script">
<link rel="preload" href="/1.3a7a0def.js" as="script">
<link rel="preload" href="/2.ce639a67.js" as="script">
<link rel="preload" href="/17.3ce2da75.js" as="script">
<link rel="preload" href="/18.3dd24f10.js" as="script">
<link rel="preload" href="/20ac7829.8cc766e8.js" as="script">
<link rel="preload" href="/17896441.9778df45.js" as="script">
<link rel="preload" href="/e81195f4.e8aac01b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Interweave"><strong class="navbar__title">Interweave</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/milesj/interweave" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx moon_6SPT"></span></div><div class="react-toggle-track-x"><span class="toggle_BsTx sun_152_"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Interweave"><strong class="navbar__title">Interweave</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/milesj/interweave" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Getting started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/matchers">Matchers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/filters">Filters</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Extensions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/exts/autolink">Autolinking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/exts/emoji">Emojis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/exts/emoji-picker">Emoji picker</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/compose">Composition</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/docs/parser">HTML parsing</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ssr">Server-side rendering</a></li><li class="menu__list-item"><a href="https://github.com/milesj/interweave/blob/master/CHANGELOG.md" target="_blank" rel="noreferrer noopener" class="menu__link">Changelog</a></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">HTML parsing</h1></header><div class="markdown"><p>Interweave doesn&#x27;t rely on an HTML parser for rendering HTML safely; instead, it uses the DOM
itself. It accomplishes this by using <code>DOMImplementation.createHTMLDocument</code> (<a href="https://developer.mozilla.org/en-US/docs/Web/API/DOMImplementation/createHTMLDocument" target="_blank" rel="noopener noreferrer">MDN</a>), which
creates an HTML document in memory, allowing us to easily set markup, aggregate nodes, and generate
React elements. This implementation is supported by all modern browsers and IE9+.</p><p><code>DOMImplementation</code> has the added benefit of not requesting resources (images, scripts, etc) until
the document has been rendered to the page. This provides an extra layer of security by avoiding
possible CSRF and arbitrary code execution.</p><p>Furthermore, Interweave manages a list of both HTML tags and attributes, further increasing
security, and reducing the risk of XSS and vulnerabilities.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="allowed-tags"></a>Allowed tags<a aria-hidden="true" tabindex="-1" class="hash-link" href="#allowed-tags" title="Direct link to heading">#</a></h2><p>Interweave keeps a mapping of renderable <a href="https://github.com/milesj/interweave/blob/master/packages/core/src/constants.ts#L15" target="_blank" rel="noopener noreferrer">HTML tags to parsing configurations</a>. These
configurations handle the following rules and processes.</p><ul><li>Defines the type of rule: allow or deny.</li><li>Defines the type of tag: inline, block, inline-block.</li><li>Flags whether inline children can be rendered.</li><li>Flags whether block children can be rendered.</li><li>Flags whether children of the same tag name can be rendered.</li><li>Maps the parent tags the current element can render in.</li><li>Maps the child tags the current element can render.</li></ul><p>The following tags are not supported, but their children will still be rendered.</p><p><code>acronym</code>, <code>area</code>, <code>basefont</code>, <code>bgsound</code>, <code>big</code>, <code>blink</code>, <code>center</code>, <code>col</code>, <code>content</code>, <code>data</code>,
<code>datalist</code>, <code>dialog</code>, <code>dir</code>, <code>font</code>, <code>form</code>, <code>hgroup</code>, <code>image</code>, <code>input</code>, <code>isindex</code>, <code>keygen</code>,
<code>listing</code>, <code>marquee</code>, <code>menu</code>, <code>menuitem</code>, <code>meter</code>, <code>multicol</code>, <code>nobr</code>, <code>noembed</code>, <code>noframes</code>,
<code>optgroup</code>, <code>option</code>, <code>param</code>, <code>plaintext</code>, <code>progress</code>, <code>select</code>, <code>shadow</code>, <code>slot</code>, <code>spacer</code>,
<code>strike</code>, <code>template</code>, <code>textarea</code>, <code>tt</code>, <code>wbr</code>, <code>xmp</code></p><p>The following tags and their children will never be rendered, even when the allow list is disabled.</p><p><code>applet</code>, <code>base</code>, <code>body</code>, <code>canvas</code>, <code>command</code>, <code>embed</code>, <code>frame</code>, <code>frameset</code>, <code>head</code>, <code>html</code>, <code>link</code>,
<code>meta</code>, <code>noscript</code>, <code>object</code>, <code>script</code>, <code>style</code>, <code>title</code></p><blockquote><p>The list of allowed tags can be customized using the <code>allowList</code> prop, which accepts a list of
HTML tag names.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="allowed-attributes"></a>Allowed attributes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#allowed-attributes" title="Direct link to heading">#</a></h2><p>Interweave takes parsing a step further, by also <a href="/docs/filters">filtering</a> attribute values and
HTML nodes. Like tags, a mapping of renderable <a href="https://github.com/milesj/interweave/blob/master/packages/core/src/constants.ts#L306" target="_blank" rel="noopener noreferrer">HTML attributes to parser rules</a> exist. A
rule can be one of: allow and cast to string (default), allow and cast to number, allow and cast to
boolean, and finally, deny.</p><blockquote><p>Any attribute not found in the mapping will be ignored unless <code>allowAttributes</code> is passed.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="render-precedence"></a>Render precedence<a aria-hidden="true" tabindex="-1" class="hash-link" href="#render-precedence" title="Direct link to heading">#</a></h2><p>There are 3 levels of rendering, in order:</p><ul><li><strong>Banned</strong> - Tags that will <em>never</em> be rendered, regardless of the allow list, or what the
consumer configures. This is based on the <code>BANNED_TAG_LIST</code> constant. This takes the highest
precedence.</li><li><strong>Blocked</strong> - Tags that will <em>not</em> be rendered and are configured through the consumer with the
<code>blockList</code> prop. This takes precedence over <code>allowList</code> and <code>allowElements</code>.</li><li><strong>Allowed</strong> - Tags that will be rendered. The default allow list is based on the
<code>ALLOWED_TAG_LIST</code> constant, or can be configured by the consumer with the <code>allowList</code> prop. The
<code>allowElements</code> prop has a higher precedence than <code>allowList</code>, but both of which are lower than
blocked or banned tags.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="by-passing-allowed"></a>By-passing allowed<a aria-hidden="true" tabindex="-1" class="hash-link" href="#by-passing-allowed" title="Direct link to heading">#</a></h2><p>If need be, the allowed tag list can be disabled with the <code>allowElements</code> prop, which renders all
HTML elements except for banned tags (hard-coded) and blocked tags (provided by <code>blockList</code>).
Furthermore, the allowed attribute list can be disabled with <code>allowAttributes</code>, which renders all
non-event and non-XSS attack vector attributes.</p><p>These props are highly discouraged as it opens up possible XSS and injection attacks, and should
only be used if the markup passed to <code>Interweave</code> has been sanitized beforehand.</p><p>That being said, banned tags like <code>script</code>, <code>applet</code>, and a few others are consistently removed.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="replacing-elements"></a>Replacing elements<a aria-hidden="true" tabindex="-1" class="hash-link" href="#replacing-elements" title="Direct link to heading">#</a></h2><p>By default, Interweave converts tags to an <code>&lt;Element /&gt;</code> React component, which renders the
appropriate DOM node. For custom block-level elements, the <code>transform</code> function prop can be passed.</p><p>This function receives the parsed DOM node, and can return either a React element (which is inserted
into the React element tree), undefined to use the default <code>&lt;Element /&gt;</code> component, or null to skip
the element entirely.</p><p>For example, to replace <code>a</code> elements with a custom element:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-tsx codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token maybe-class-name">Interweave</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token maybe-class-name">Node</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;interweave&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">transform</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">node</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token parameter"> HTMLElement</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> children</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token parameter"> Node</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token maybe-class-name">ReactNode</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">tagName </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;a&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">Link</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">href</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token tag script language-javascript" style="color:rgb(255, 85, 114)">node</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token tag script language-javascript function" style="color:rgb(130, 170, 255)">getAttribute</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token tag script language-javascript string" style="color:rgb(195, 232, 141)">&#x27;href&#x27;</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">children</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">Link</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">Interweave</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">transform</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token tag script language-javascript" style="color:rgb(255, 85, 114)">transform</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div></div></div><p>Note that <code>transform</code> is run before checking the allowed list, permitting you to use non-allowed
tags in a controlled way. Banned tags like <code>script</code> will not be transformed.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="disabling-html"></a>Disabling HTML<a aria-hidden="true" tabindex="-1" class="hash-link" href="#disabling-html" title="Direct link to heading">#</a></h2><p>The HTML parser cannot be disabled, however, a <code>noHtml</code> boolean prop can be passed to both the
<code>&lt;Interweave /&gt;</code> and <code>&lt;Markup /&gt;</code> components. This prop will mark all HTML elements as pass-through,
simply rendering text nodes recursively, including matchers.</p><p>If you want to strip user provided HTML, but allow HTML from matchers, use the
<code>noHtmlExceptMatchers</code> prop instead.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/milesj/interweave/edit/master/website/docs/parser.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/compose"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Composition</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/ssr"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Server-side rendering »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#allowed-tags" class="table-of-contents__link">Allowed tags</a></li><li><a href="#allowed-attributes" class="table-of-contents__link">Allowed attributes</a></li><li><a href="#render-precedence" class="table-of-contents__link">Render precedence</a></li><li><a href="#by-passing-allowed" class="table-of-contents__link">By-passing allowed</a></li><li><a href="#replacing-elements" class="table-of-contents__link">Replacing elements</a></li><li><a href="#disabling-html" class="table-of-contents__link">Disabling HTML</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright © 2020 Miles Johnson. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.0d221f0c.js"></script>
<script src="/runtime~main.565a1149.js"></script>
<script src="/main.6efb486e.js"></script>
<script src="/1.3a7a0def.js"></script>
<script src="/2.ce639a67.js"></script>
<script src="/17.3ce2da75.js"></script>
<script src="/18.3dd24f10.js"></script>
<script src="/20ac7829.8cc766e8.js"></script>
<script src="/17896441.9778df45.js"></script>
<script src="/e81195f4.e8aac01b.js"></script>
</body>
</html>